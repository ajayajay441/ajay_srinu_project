<div class="invoice-page">
  <div
    fxLayout="row"
    fxLayoutGap="15px"
    class="mb-10"
    fxLayoutAlign="space-between center"
  >
    <div
      fxFlex="80"
      fxLayout="row wrap"
      fxLayoutGap="25px"
      fxLayoutAlign="start center"
    >
      <h1 class="mb-0">Invoice</h1>
      <div
        fxLayout="row"
        fxLayoutGap="15px"
        fxLayoutAlign="space-between center"
        class="shipments-page-selectbox"
      >
        <h3 class="mb-0">Filter:</h3>
        <mat-form-field class="w-full">
          <!-- <mat-label>Status</mat-label> -->
          <mat-select>
            <mat-option> Monthly </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </div>
    <div fxFlex="20" class="text-right">
      <button mat-raised-button color="primary" class="mat-elevation-z0">
        <mat-icon>upload_file</mat-icon>
        Download
      </button>
    </div>
    <div fxFlex="20" class="text-right">
      <button mat-raised-button color="primary" class="mat-elevation-z0">
        <mat-icon>upload_file</mat-icon>
        Ageing + O/s report
      </button>
    </div>
  </div>
  <div class="mb-10">
    <div
      class="mb-9"
      fxLayout="row"
      fxLayoutGap="25px"
      fxLayoutAlign="start center"
    >
      <div class="inv_box">
        <div class="my-3 mx-3 text-base"><strong>Total due amount</strong></div>
        <div class="my-3 mx-3 text-2xl">
          <strong>$27632</strong
          ><span class="green px-2"
            >+2.5%<svg
              width="12"
              height="12"
              viewBox="0 0 12 12"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M6.66664 11.3333V0.666667C6.66664 0.298477 6.36816 2.47154e-07 5.99997 2.47154e-07C5.63178 2.47154e-07 5.3333 0.298477 5.3333 0.666667V11.3333C5.3333 11.7015 5.63178 12 5.99997 12C6.36816 12 6.66664 11.7015 6.66664 11.3333Z"
                fill="#3DD598"
              />
              <path
                d="M5.99404 1.67906L10.1652 6.43936C10.4079 6.71628 10.8291 6.74406 11.106 6.50141C11.3829 6.25876 11.4107 5.83756 11.168 5.56064L6.49473 0.22731C6.22891 -0.0760547 5.75669 -0.0757209 5.49129 0.228018L0.831274 5.56135C0.589015 5.83861 0.617391 6.25977 0.894653 6.50203C1.17192 6.74429 1.59307 6.71591 1.83533 6.43865L5.99404 1.67906Z"
                fill="#3DD598"
              />
            </svg>
          </span>
        </div>
        <div class="my-3 mx-3 text-base para">
          Number of unpaid invoices : 54
        </div>
      </div>
      <div class="inv_box">
        <div class="my-3 mx-3 text-base"><strong>Overdue amount</strong></div>
        <div class="my-3 mx-3 text-2xl">
          <strong>$20199</strong
          ><span class="green px-2"
            >+0.5%<svg
              width="12"
              height="12"
              viewBox="0 0 12 12"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M6.66664 11.3333V0.666667C6.66664 0.298477 6.36816 2.47154e-07 5.99997 2.47154e-07C5.63178 2.47154e-07 5.3333 0.298477 5.3333 0.666667V11.3333C5.3333 11.7015 5.63178 12 5.99997 12C6.36816 12 6.66664 11.7015 6.66664 11.3333Z"
                fill="#3DD598"
              />
              <path
                d="M5.99404 1.67906L10.1652 6.43936C10.4079 6.71628 10.8291 6.74406 11.106 6.50141C11.3829 6.25876 11.4107 5.83756 11.168 5.56064L6.49473 0.22731C6.22891 -0.0760547 5.75669 -0.0757209 5.49129 0.228018L0.831274 5.56135C0.589015 5.83861 0.617391 6.25977 0.894653 6.50203C1.17192 6.74429 1.59307 6.71591 1.83533 6.43865L5.99404 1.67906Z"
                fill="#3DD598"
              />
            </svg>
          </span>
        </div>
        <div class="my-3 mx-3 text-base para">
          Number of unpaid invoices : 54
        </div>
      </div>
    </div>
  </div>
  <div class="mb-10">
    <mat-card class="mat-elevation-z0">
      <div
        class="card-title mb-9"
        fxLayout="row"
        fxLayoutAlign="space-between center"
      >
        <div fxLayout="row" fxLayoutGap="25px">
          <h2 class="mb-0">Invoices</h2>
          <button
            mat-stroked-button
            *ngFor="let _invoiceType of invoiceTypes"
            [color]="
              _invoiceType.value == activeInvoiceStatusType
                ? 'primary'
                : 'light'
            "
            class="mat-elevation-z0"
            (click)="getDashboardInvoice(_invoiceType.value)"
          >
            {{ _invoiceType.label }}
          </button>
        </div>
        <div class="search-form">
          <form>
            <mat-form-field class="quotations-search-input">
              <mat-label class="">Search</mat-label>
              <mat-icon matPrefix class="search-icon">search</mat-icon>
              <input
                type="search"
                matInput
                [ngModel]="filter"
                name="filterField"
                (ngModelChange)="filterChanged($event)"
              />
            </mat-form-field>
          </form>
        </div>
      </div>
    </mat-card>
  </div>
  <mat-spinner *ngIf="loading" class="spinner"></mat-spinner>
  <div class="mb-10" *ngIf="!loading">
    <table
      mat-table
      [dataSource]="dataSource"
      matSort
      class="w-full mat-elevation-z0"
      multiTemplateDataRows
    >
      <!-- Position Column -->
      <ng-container matColumnDef="inv_number">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Invoice N°</th>
        <td mat-cell *matCellDef="let element">{{ element.inv_number }}</td>
      </ng-container>

      <!-- for expansion panel every row expansion details -->
      <ng-container matColumnDef="expandedDetail">
        <td
          mat-cell
          *matCellDef="let element"
          [attr.colspan]="displayedColumns.length"
        >
          <div
            class="element-detail"
            [@detailExpand]="
              element == expandedElement ? 'expanded' : 'collapsed'
            "
          >
            <mat-tab-group
              mat-align-tabs="start"
              color="primary"
              class="w-full"
            >
              <mat-tab label="PO">
                <mat-card class="mat-elevation-z0">
                  <div class="card-body">
                    <div fxLayout="column" fxLayoutAlign="center space-between">
                      <div
                        fxLayout="row"
                        fxLayoutAlign="start center"
                        fxLayoutGap="10px"
                        class="py-3 schedules-table-header"
                      >
                        <h3 fxFlex class="mb-0">Ref. Number</h3>
                        <h3 fxFlex class="mb-0">PO N°</h3>
                        <h3 fxFlex class="mb-0">Origin</h3>
                        <h3 fxFlex class="mb-0">Destination</h3>
                        <h3 fxFlex class="mb-0">Chargeable weight</h3>
                        <h3 fxFlex class="mb-0">Supplier</h3>
                        <h3 fxFlex class="mb-0">Container Number</h3>
                        <h3 fxFlex class="mb-0">Mode</h3>
                        <h3 fxFlex class="mb-0">Shipment</h3>
                      </div>
                      <div
                        fxLayout="row"
                        fxLayoutAlign="start center"
                        fxLayoutGap="10px"
                        class="my-3 schedule-item"
                      >
                        <h5 fxFlex class="mb-0">21390</h5>
                        <h5 fxFlex class="mb-0">21390</h5>
                        <h5 fxFlex class="mb-0">21390</h5>
                        <h5 fxFlex class="mb-0">Parallel Inc.</h5>
                        <h5 fxFlex class="mb-0">Parallel Inc.</h5>
                        <h5 fxFlex class="mb-0">Parallel Inc.</h5>
                        <h5 fxFlex class="mb-0">3499485 / 349943 / 349943</h5>
                        <h5 fxFlex class="mb-0">Air</h5>
                        <h5 fxFlex class="mb-0">Air</h5>
                      </div>
                    </div>
                  </div>
                </mat-card>
              </mat-tab>
              <mat-tab label="Documents">
                <mat-card class="mat-elevation-z0">
                  <div class="card-body">
                    <div fxHide fxShow.gt-md>
                      <div
                        fxLayout="row"
                        fxLayoutGap="10px"
                        fxLayoutAlign="start center"
                        class="py-3 header-row"
                      >
                        <div fxFlex="250px" class="px-3">Document Date</div>
                        <div fxFlex class="px-3">Document Name</div>
                      </div>
                      <div
                        fxLayout="row"
                        fxLayoutAlign="start center"
                        fxLayoutGap="10px"
                        class="py-3"
                      >
                        <div fxFlex="250px" class="px-3">Date</div>
                        <div
                          fxFlex
                          class="px-3"
                          fxLayout="row"
                          fxLayoutAlign="space-between center"
                          fxLayoutGap="10px"
                        >
                          <div fxFlex>
                            <p>Name</p>
                          </div>
                          <div fxFlex class="text-right">
                            <button
                              mat-raised-button
                              color="primary"
                              class="mat-elevation-z0"
                            >
                              <mat-icon>upload_file</mat-icon>
                              <a href="" target="_blank"> Download</a>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </mat-card>
              </mat-tab>
            </mat-tab-group>
          </div>
        </td>
      </ng-container>

      <!-- Name Column -->
      <ng-container matColumnDef="inv_date">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Invoice Date</th>
        <td mat-cell *matCellDef="let element">{{ element.inv_date }}</td>
      </ng-container>

      <!-- Weight Column -->
      <ng-container matColumnDef="house_no">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>House N°</th>
        <td mat-cell *matCellDef="let element">{{ element.house_no }}</td>
      </ng-container>

      <!-- Symbol Column -->
      <ng-container matColumnDef="due_date">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Due Date</th>
        <td mat-cell *matCellDef="let element">
          {{ element.due_date }}
        </td>
      </ng-container>
      <ng-container matColumnDef="days">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Days</th>
        <td mat-cell *matCellDef="let element">
          {{ element.days }}
        </td>
      </ng-container>
      <ng-container matColumnDef="amount">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Amount</th>
        <td mat-cell *matCellDef="let element">
          {{ element.amount }}
        </td>
      </ng-container>
      <ng-container matColumnDef="balance">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Balance</th>
        <td mat-cell *matCellDef="let element">
          {{ element.balance }}
        </td>
      </ng-container>

      <ng-container matColumnDef="details">
        <th mat-header-cell *matHeaderCellDef mat-sort-header></th>
        <td mat-cell *matCellDef="let element">
          <a
            class="underline cursor-pointer mat-primary"
            (click)="
              expandedElement = expandedElement === element ? null : element;
              getinvoicedetail(element.inv_number)
            "
          >
            See Details
          </a>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>

      <tr
        mat-row
        *matRowDef="let element; columns: displayedColumns"
        class="element-row"
        [class.expanded-row]="expandedElement === element"
      ></tr>

      <tr
        mat-row
        *matRowDef="let row; columns: ['expandedDetail']"
        class="detail-row"
      ></tr>
    </table>
    <mat-paginator
      [pageSizeOptions]="[5, 10, 20]"
      showFirstLastButtons
    ></mat-paginator>
  </div>
</div>
